<!doctype html><meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Fichaje</title>
<body style="font-family:system-ui,Arial;padding:24px;text-align:center">
  <h3>Fichaje Puertas Lloris</h3>
  <p>Pulsa el botón para registrar el fichaje.</p>
  <p><button id="go" style="background:#16a34a;color:#fff;border:0;border-radius:10px;
     padding:14px 18px;font-size:18px;font-weight:600">Fichar ahora</button></p>
  <p><a id="link" href="#" style="font-size:14px;">Si no se abre, toca aquí</a></p>
<script>
  const p = new URLSearchParams(location.search);
  const base = "https://script.google.com/macros/s/AKfycbzQgMYWw08WXbJr5_SOhGKiHyqlU_Sh0ZU67dg2yS9DjDBMRMUbLemPBU9apPdKQa-c/exec";
  const url  = base + "?" + p.toString() + "&t=" + Date.now();

  // Enlace visible por si el popup es bloqueado
  document.getElementById('link').href = url;

  // Apertura por gesto del usuario: evita el visor de Gmail/iOS
  document.getElementById('go').addEventListener('click', () => {
    // preferimos nueva pestaña para forzar navegador del sistema
    window.open(url, '_blank', 'noopener');
  });

  // Intento pasivo (por si no es Gmail/iOS)
  setTimeout(() => { try { location.href = url; } catch(_){} }, 600);
</script>
</body>
